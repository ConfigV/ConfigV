Resources.AWS::KinesisAnalytics::Application.Properties.ApplicationDescription,Kineis Analytics Anomaly Application
Resources.AWS::KinesisAnalytics::ApplicationOutput.Properties.Output.Name,DESTINATION_SQL_STREAM
Resources.AWS::KinesisAnalytics::ApplicationOutput.Properties.ApplicationName,{u'Ref': u'KinesisAnomalyApplication'}
Resources.AWS::KinesisAnalytics::ApplicationOutput.Properties.Output.KinesisStreamsOutput.RoleARN,{u'Fn::ImportValue': {u'Fn::Sub': u'${SupportingStack}-KinesisAnalyticsRoleArn'}}
Parameters.SupportingStack.Type,String
Resources.AWS::KinesisAnalytics::Application.Type,AWS::KinesisAnalytics::Application
Resources.AWS::KinesisAnalytics::ApplicationOutput.Properties.Output.KinesisStreamsOutput.ResourceARN,{u'Fn::ImportValue': {u'Fn::Sub': u'${SupportingStack}-OutputStreamArn'}}
Parameters.SupportingStack.ConstraintDescription,name of previous stack
Parameters.SupportingStack.Description,Stack name used when deploying to click stream example supporting elements.
Resources.AWS::KinesisAnalytics::Application.Properties.ApplicationCode,"{u'Fn::Join': [u'', [u'CREATE OR REPLACE STREAM ""CLICKSTREAM"" ( \n', u'\t""CLICKCOUNT"" DOUBLE\n', u');\n\n', u'CREATE OR REPLACE PUMP ""CLICKPUMP"" AS\n', u'INSERT INTO ""CLICKSTREAM"" (""CLICKCOUNT"")\n', u'SELECT STREAM COUNT(*)\n', u'FROM ""SOURCE_SQL_STREAM_001""\n', u'WHERE ""browseraction"" = \'Click\'\n', u'GROUP BY FLOOR(\n', u'\t(""SOURCE_SQL_STREAM_001"".ROWTIME - TIMESTAMP \'1970-01-01 00:00:00\')\n', u'\t\tSECOND / 10 TO SECOND\n', u');\n\n', u'CREATE OR REPLACE STREAM ""IMPRESSIONSTREAM"" ( \n', u'\t""IMPRESSIONCOUNT"" DOUBLE\n', u');\n\n', u'CREATE OR REPLACE PUMP ""IMPRESSIONPUMP"" AS \n', u'INSERT INTO ""IMPRESSIONSTREAM"" (""IMPRESSIONCOUNT"") \n', u'SELECT STREAM COUNT(*) \n', u'FROM ""SOURCE_SQL_STREAM_001""\n', u'WHERE ""browseraction"" = \'Impression\'\n', u'GROUP BY FLOOR(\n', u'\t(""SOURCE_SQL_STREAM_001"".ROWTIME - TIMESTAMP \'1970-01-01 00:00:00\')\n', u'\t\tSECOND / 10 TO SECOND\n', u');\n\n', u'CREATE OR REPLACE STREAM ""CTRSTREAM"" (\n', u'\t""CTR"" DOUBLE\n', u');\n\n', u'CREATE OR REPLACE PUMP ""CTRPUMP"" AS \n', u'INSERT INTO ""CTRSTREAM"" (""CTR"")\n', u'SELECT STREAM ""CLICKCOUNT"" / ""IMPRESSIONCOUNT"" * 100.000 as ""CTR""\n', u'FROM ""IMPRESSIONSTREAM"",\n', u'\t""CLICKSTREAM""\n', u'WHERE ""IMPRESSIONSTREAM"".ROWTIME = ""CLICKSTREAM"".ROWTIME;\n\n', u'CREATE OR REPLACE STREAM ""DESTINATION_SQL_STREAM"" (\n', u'\t""CTRPERCENT"" DOUBLE,\n', u'\t""ANOMALY_SCORE"" DOUBLE\n', u');\n\n', u'CREATE OR REPLACE PUMP ""OUTPUT_PUMP"" AS \n', u'INSERT INTO ""DESTINATION_SQL_STREAM""\n', u'SELECT STREAM * FROM\n', u'TABLE (RANDOM_CUT_FOREST( \n', u'\t\t\tCURSOR(SELECT STREAM ""CTR"" FROM ""CTRSTREAM""), --inputStream\n', u'\t\t\t100, --numberOfTrees (default)\n', u'\t\t\t12, --subSampleSize \n', u'\t\t\t100000, --timeDecay (default)\n', u'\t\t\t1) --shingleSize (default)\n', u')\n', u'WHERE ANOMALY_SCORE > 2;\n']]}"
Resources.AWS::KinesisAnalytics::ApplicationOutput.Type,AWS::KinesisAnalytics::ApplicationOutput
Resources.AWS::KinesisAnalytics::ApplicationOutput.Properties.Output.DestinationSchema.RecordFormatType,CSV
Resources.AWS::KinesisAnalytics::Application.Properties.ApplicationName,KineisAnalyticsAnomalyApplication
Resources.AWS::KinesisAnalytics::Application.Properties.Inputs,"[{u'KinesisStreamsInput': {u'ResourceARN': {u'Fn::ImportValue': {u'Fn::Sub': u'${SupportingStack}-InputStreamArn'}}, u'RoleARN': {u'Fn::ImportValue': {u'Fn::Sub': u'${SupportingStack}-KinesisAnalyticsRoleArn'}}}, u'InputSchema': {u'RecordColumns': [{u'SqlType': u'VARCHAR(16)', u'Name': u'browseraction', u'Mapping': u'$.browseraction'}, {u'SqlType': u'VARCHAR(64)', u'Name': u'site', u'Mapping': u'$.site'}], u'RecordFormat': {u'MappingParameters': {u'JSONMappingParameters': {u'RecordRowPath': u'$'}}, u'RecordFormatType': u'JSON'}}, u'NamePrefix': u'SOURCE_SQL_STREAM'}]"
