\section{Motivating Examples}
\label{sec-motiv}

In this section, we present several {\em tricky} configuration errors
extracted from real-world examples. 
The reason we call them tricky is that
most existing efforts, \eg, learning-based checking
efforts~\cite{zhang14encore, wang04automatic}, cannot detect
these configuration errors.
On the other hand, we also investigated 
many misconfiguration problems in practice which were caused by 
these tricky configuration errors, \eg, reported by Stack Overflow.

\para{Example~1: Ordering errors.} 
The first example configuration error is first reported by 
Yin {\em et al.}~\cite{yin11anempirical}.
For instance, when a user configures PHP to run with the
Apache HTTP Server, this user may write, among others, 
the following lines in the configuration file.

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
extension = mysql.so
...
extension = recode.so
\end{lstlisting} 

Such a configuration file will cause the Apache server to 
fail to start due to a segmentation fault error~\cite{yin11anempirical}. 
This is because when using PHP in Apache, the extension {\tt mysql.so} 
depends on {\tt recode.so}, and the relative ordering of two of them 
is crucial. 
We call the above example misconfiguration 
an {\em ordering error}.
Yin {\em et al.} find that ordering errors widely exist in
many system configurations, \eg, PHP and MySQL,
and typically lead to multiple system crash events;
however, there is no existing effort that can effectively solve 
or detect this problem~\cite{zhang14encore, xu15systems, xu13do}.

If this user is using \app, she can avoid such a configuration error.
In particular, \app is able to inform the user that {\tt recode.so} 
should appear before {\tt mysql.so} and reports the error (as shown
below).

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
ORDERING ERROR: Expected "extension" "recode.so"
BEFORE "extension" "mysql.so"
\end{lstlisting} 

\para{Example~2: Fine-grained value correlation errors.} 
In a real-world misconfiguration example~\cite{correlation}, 
a user configures his MySQL as the following:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
key_buffer_size = 384M
max_heap_table_size = 128M
max_connections = 64
thread_cache_size = 8
...
sort_buffer_size = 32M
join_buffer_size = 32M
read_buffer_size = 32M
read_rnd_buffer_size = 8M
...
\end{lstlisting} 

This user complained that his MySQL's load was very high and the website's
respond speed was very slow.
In this case, {\tt key\_buffer\_size} is used by all the threads
cooperatively, while {\tt join\_buffer} and {\tt sort\_buffer} are 
created by each thread for private use; thus, the maximum amount
of used key buffer, \ie, {\tt key\_buffer\_size} should be larger than 
{\tt join|sort\_buffer\_size} * {\tt max\_connections}. 
Clearly, in the above example, it does not hold, 
so this misconfiguration causes MySQL to load very slowly.

We call the above situation a {\em fine-grained value correlation
error}, which is a more challenging case than 
{\em value correlation error} reported
by some existing investigations~\cite{yin11anempirical, zhang14encore}.
A typical value correlation error
means one entry's value should have a certain correlation with
another entry's value. For example, in MySQL,
the value of {\tt max\_connections} should be higher than
{\tt mysql.max\_persistent}. Although some work, \eg,
EnCore~\cite{zhang14encore}, can detect the normal value
correlation case, 
no existing effort can detect fine-grained value correlation
errors, which ``hide'' equation-aware correlations, as shown in
the above example.
As mentioned by Xu {\em et al.}~\cite{xu15hey},
detecting fine-grained value correlation errors 
is a much more challenging
task than the normal value correlation problem.

To the best of our knowledge, \app is the first effort that
is able to check such fine-grained value correlation problems.
If we run \app on this configuration file, \app  would return:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
INTEGER RELATION ERROR:
Expected "key_buffer_size" >= "max_connections" * "sort_buffer_size"
\end{lstlisting} 

\jon{The following paragraph is repetitive, same as the one two above -- just remove it?}
Note that an existing effort, EnCore, aims to detect value correlation 
errors. However, different from \app, EnCore can only detect simple
correlations, \eg, {\tt mysql.max\_persistent} < {\tt max\_connections},
rather than the fine-grained computation-based value correlation,
like {\tt key\_buffer\_size >= max\_connections * sort\_buffer\_size}
identified by \app.

\para{Example~3: Entry missing errors.} 
Many critical system outages result from the fact that an important
entry was missing in the configuration file. 
We call such a problem an {\em entry missing error}.
In a public misconfiguration dataset~\cite{configdataset},
many MySQL failure reports were caused by
missing entry errors.
Below is a real-world entry missing error example~\cite{yin11anempirical}:
when a user wants to use OpenLDAP to enable her directory access
protocol, she needs to use the password policy overlay. This is usually
done through the following entries in the OpenLDAP configuration file:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
include schema/ppolicy.schema
overlay ppolicy
\end{lstlisting} 

When using the password policy overlay in OpenLDAP, 
users have to first include the related schema.
Leaving out the {\tt include} entry, 
which has been left out by many users~\cite{yin11anempirical}, 
will cause failure of this LDAP. 
The user can run \app on such a misconfiguration file,
and \app would return:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
MISSING KEYWORD ERROR: Expected "overlay" "ppolicy"
in the same file: "include" "schema/ppolicy.schema"
\end{lstlisting} 

\ennan{Example~4: This should be the singular value error.
We need an example from Stack Overflow to illustrate the 
real-world problem. I guess the buffer size example is fine.}

\para{Other errors.}
\app can also deal with the configuration errors that can be detected by
existing work, such as EnCore~\cite{zhang14encore} and
CODE~\cite{yuan11context}.
A configuration error reported recently made the MySQL
daemon fail to start~\cite{syserror}.
One entry was written as 
{\tt datadir=/root/appfinder/mysql}, and the type, as well as 
format, seemed correct.
However, the problem is that this directory should not 
contain the root directory; the correct entry
should be {\tt datadir=/appfinder/mysql}.
Such an error is called a system environment-related configuration error.
Both \app and EnCore can handle misconfigurations concerning system execution.
Furthermore, \app is also able to detect type errors and syntax errors
in configuration files.
