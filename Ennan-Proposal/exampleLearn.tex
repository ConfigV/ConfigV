
\begin{tikzpicture}[%
    >=stealth' % here you can choose the arrow tip of your choice
		]
\tikzset{% define styles for the different boxes, adjust parameters to wish
  base/.style={align=center, minimum height=5mm, minimum width=10mm, draw=black,thick},
	circ/.style={align=center, minimum width=4mm, circle, draw=black,thick},
	% coord node style is used for drawing the arrows i.e. invisible nodes
  coord/.style={coordinate},
}
	
\matrix [column sep=10mm, row sep=14mm, every node/.style={
    shape=rectangle,
    text width=2.75cm,
    text centered,
    very thick,
    draw=none,
}] {
\node (a) {file 1}; &
\node (b) {file 2};
};

\node [base,minimum width=12mm,minimum height=9mm,above=0mm of a,draw=black,dotted,thin](abox) {f};
\node [base,above left=2mm and 3mm of b.north](bbox1) {a1};
\node [base,above right=2mm and 3mm of b.north](bbox2) {a2};
\node [base,above=4mm of c](cbox) {a};
\node [base,above=4mm of d](dbox) {a};

\tikzset{% define styles for the different boxes, adjust parameters to wish
  base/.style={align=center, minimum height=5mm, minimum width=10mm, draw=black,dotted},
	circ/.style={align=center, minimum width=5mm, circle, draw=black,thick},
	% coord node style is used for drawing the arrows i.e. invisible nodes
  coord/.style={coordinate},
}

% add large box to two boxes in b
\node [base, minimum width=28mm,minimum height=9mm, above=0mm of a](bboxLarge){};

% add larger box to c and d
\node [base, minimum width=24mm, minimum height =10.5mm, above=0mm of c](cboxLarge){};
\node [base, minimum width=24mm, minimum height =10.5mm, above=0mm of d](dboxLarge){};

% add coordinates to allow for drawing of the arrows
\node [coord,left=7mm of acirc](c_a1){};
\node [coord,right=7mm of acirc](c_a2){};
\node [coord,left=6mm of bbox1](c_b1){};
\node [coord,right=6mm of bbox2](c_b2){};
\node [coord,left=10mm of cbox](c_c1){};
\node [coord,right=10mm of cbox](c_c2){};
\node [coord,left=10mm of dbox](c_d1){};
\node [coord,right=10mm of dbox](c_d2){};

% finally add the arrows
\begin{scope}[->, thick]
\draw (c_a1) -- (acirc.west);
\draw (acirc.east) -- (c_a2);

\draw (c_b1) -- (bbox1);
\draw (bbox1) -- (bbox2);
\draw (bbox2) -- (c_b2);

\draw (c_c1) -- (cbox);
\draw (cbox) -- (c_c2);
\draw ([yshift=-4mm]c_c1) -- ([yshift=-4mm]c_c2);

\draw ([yshift=1mm]c_d1.east) -- ([yshift=1mm]dbox.west);
\draw ([yshift=1mm]dbox.east) -- ([yshift=1mm]c_d2.west);
\draw ([yshift=-1mm]dbox.east) to [out=346,in=194,looseness=6] ([yshift=-1mm]dbox.west);
\end{scope}

\end{tikzpicture}
