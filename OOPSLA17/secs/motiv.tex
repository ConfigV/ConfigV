\section{Motivating Examples}
\label{sec:motiv}

In this section we illustrate capabilities of \app by 
using several real-world misconfiguration examples. 
These examples are sophisticated configuration errors
that were reported on StackOverflow~\cite{stackoverflow},
a popular forum for programmers and administrators. 

\para{Example~1: Missing Entry Errors} 
Many critical system outages result from the fact that an important
entry was missing from the configuration file. 
We call such a problem a {\em missing entry error}.
In a public misconfiguration 
dataset~\cite{configdataset}, many misconfiguration issues were 
reported exactly to be missing entry errors.
Below is a real-world missing entry error example~\cite{missingentry}:
when a user configures her PHP and PostgreSQL,
she needs to use both \code{pgsql.so} and \code{curl.so}
in the \code{/ctc/php5/conf.d/curl.ini} configuration file.
This is usually
achieved by the following entries in 
the curl configuration file:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    extension=pgsql.so
    extension=curl.so
    ...
\end{lstlisting} 

However, in this example the user accidentally
left out the \code{extension=pgsql.so} entry, 
as done by many users~\cite{yin11anempirical, missingentry}, 
causing a segmentation fault. 
If the user would run \app on her file,
our tool returns:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    MISSING ENTRY ERROR: Expected "extension=pgsal.so"
    in the same file: "extension=curl.so"
\end{lstlisting} 

%TODO would be nice to have these as subsection or somehow be able to ref specific examples
\para{Example~2: Fine-grained Integer Correlation Errors}
\label{ex:fine}
Our second misconfiguration example~\cite{correlation} 
comes from a discussion on StackOverflow.
The user has configured her MySQL as follows:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
  max_connections               = 64
  thread_cache_size             = 8
  thread_concurrency            = 8
  key_buffer_size               = 4G
  max_heap_table_size           = 128M
  join_buffer_size              = 32M
  sort_buffer_size              = 32M    
\end{lstlisting} 

The user then complains that her MySQL load was very high, 
causing the website's response speed to be very slow.
The accepted answer to the post reveals that the value \code{key\_buffer\_size} 
is used by all the threads cooperatively, 
while \code{join\_buffer} and \code{sort\_buffer} are created 
by each thread for private use.
By further consulting the MySQL manual, 
we are instructed that when setting \code{key\_buffer\_size} we should consider the memory requirement of other storage engines.
In a very indirect manner, we have learned that there is a correlation
between \code{key\_buffer\_size} and other buffer sizes of the system.
\app learns a specific constraint, \ie
\code{key\_buffer\_size} should not be greater than
\code{sort\_buffer\_size} * \code{max\_connections}.
If we run \app on the above configuration file, \app will give an explicit answer:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
FINE GRAINED ERROR: Expected 
  "max_connections" * "sort_buffer_size" > "key_buffer_size"
\end{lstlisting} 

%This example is a tricky configuration error, which implicitly
%includes a computational correlation among different entries
%in the configuration file.
We call these errors {\em fine-grained integer correlations}. 
\app can also detect simpler integer correlation: one entry's
value should have a certain correlation with another entry's 
value.
For instance, in MySQL, the value of \code{key\_buffer} 
should be larger than \code{max\_allowed\_packet}.
While several existing tools~\cite{santolucitoCAV, zhang14encore}
can detect simple integer correlation errors,
\app is, to the best of our knowledge, the first system capable of
detecting such complex fine-grained integer correlation errors.

\para{Example~3: Type Errors} 
Many system availability problems are caused by 
assigning incorrect values of an incorrect type to a keyword. Consider the following  misconfiguration
file from github~\cite{typeerror}:
a user tries to install MySQL and she needs to initiate the path
of the log information generated by MySQL.
This user puts the following entry assignment in her MySQL
configuration file: 

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    slow-query-log = /var/log/mysql/slow.log
\end{lstlisting} 

This misconfiguration will lead to 
MySQL fails to start~\cite{querylog}. With \app, this user can get the following result:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
TYPE ERROR: Expected an integer type for "slow-query-log"
\end{lstlisting} 
This was indeed the error, since in MySQL there is another entry 
named ``slow-query-log-file'' used to specify the log path.

\para{Example~4: Ordering Errors} 
Ordering errors in software configurations were first reported by 
Yin {\em et al.}~\cite{yin11anempirical}, but not many existing tools
can detect them. The following example
contains an ordering error in a MySQL configuration file
that causes the system to crash~\cite{innod-ordering}. 
%The configuration file might contain, among others, the following lines:
\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
  innodb_data_file_path          = ibdata1:10M:autoextend
  innodb_data_home_dir           = /var/lib/mysql
  innodb_flush_log_at_trx_commit = 1
  innodb_lock_wait_timeout       = 50
\end{lstlisting}

By invoking \app  the user receives a correct report that \code{innodb\_home\_dir} 
should appear before \code{innodb\_data\_file\_path}, as shown
below:
 \begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
ORDERING ERROR: Expected "innodb_data_home_dir[mysqld]" BEFORE
  "innodb_data_file_path[mysqld]" 
\end{lstlisting} 


%The above result means that we need to assign an integer value to
%the entry ``general\_log''. 
