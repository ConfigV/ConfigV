\section{Motivating Examples}
\label{sec-motiv}

In this section we present the capability of \app through 
detecting errors in several real-world misconfiguration examples. 
These examples were non-trivial configuration errors
that were reported on StackOverflow~\cite{stackoverflow},
a popular question and answer website for programmers and administrators. 
%To better understand these problems, 
%we explored and analyzed misconfigurations 
%on a large number of user forums and on-line discussion sites.

\para{Example~1: Missing entry error} 
Many critical system outages result from the fact that an important
entry was missing from the configuration file. 
We call such a problem a {\em missing entry error}.
In a public misconfiguration dataset~\cite{configdataset},
many misconfiguration issues were caused by
missing entry errors.
Below is a real-world missing entry error example~\cite{missingentry}:
when a user wants to configure her PHP and PostgreSQL,
she needs to use both {\tt pgsql.so} and {\tt curl.so}
in her {\tt /ctc/php5/conf.d/curl.ini} file.
Specifically, this is usually
achieved by the following entries in 
the curl configuration file:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    extension=pgsql.so
    extension=curl.so
\end{lstlisting} 

Nevertheless, in this example, the user 
left out the {\tt extension=pgsql.so} entry, 
as done by many users~\cite{yin11anempirical, missingentry}, 
causing a segmentation fault. 
If the user runs \app on such a misconfiguration file,
\app would return:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    MISSING ENTRY ERROR: Expected "extension=pgsal.so"
    in the same file: "extension=curl.so"
\end{lstlisting} 

%TODO would be nice to have these as subsection or somehow be able to ref specific examples
\para{Example~2: Fine-grained integer correlation error}
\label{ex:fine}
Our second misconfiguration example~\cite{correlation} 
comes from a discussion on StackOverflow.
The user has configured her MySQL as in the following:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    key_buffer_size = 384M
    max_heap_table_size = 128M
    max_connections = 64
    thread_cache_size = 8
        ...
    sort_buffer_size = 32M
    join_buffer_size = 32M
    read_buffer_size = 32M
    read_rnd_buffer_size = 8M
        ...
\end{lstlisting} 

The user complains that her MySQL load was very high, 
causing the website's
response speed to be very slow.
In this case, {\tt key\_buffer\_size} is used by all the threads
cooperatively, while {\tt join\_buffer} and {\tt sort\_buffer} are 
created by each thread for private use; thus, {\tt key\_buffer\_size},
\ie, the maximum amount of used key buffer, should be larger than 
{\tt join|sort\_buffer\_size} * {\tt max\_connections}. 
In the above example, however, it does not hold. 

If we run \app on this configuration file, \app  would return:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
  FINE GRAINED INTEGER RELATION ERROR:
  Expected "max_connections" * "sort_buffer_size"
               =< "key_buffer_size"
\end{lstlisting} 

The above example is a complex integer correlation, which implicitly
includes a computational correlation among different entries
in the configuration file.
We call these complex integer correlations as 
{\em fine-grained integer correlations}. 
Our tool can detect simple integer correlation---one entry's
value should have a certain correlation with another entry's 
value---as well.
For example, in MySQL, the value of {\tt max\_connections} 
should be higher than {\tt mysql.max\_persistent}.
While few existing tools~\cite{yin11anempirical, zhang14encore}
can detect the simple integer correlation errors,
to the best of our knowledge, \app is the first effort capable of
detecting fine-grained integer correlation problems.

\para{Example~3: Type errors} 
Many system availability problems are caused by 
assigning incorrect type of values to some key in configuration
files. Consider the following real-world misconfiguration
file~\cite{typeerror}: 
a user tries to install MySQL and she needs to initiate the path
of the log information generated by MySQL.
This user puts the following entry assignment in her MySQL
configuration file: 

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    slow-query-log = /var/log/mysql/slow.log
\end{lstlisting} 

Unbeknowest to this user, the entry ``slow-query-log'' should be an 
integer, not a string. This misconfiguration will lead to 
MySQL fails to start~\cite{querylog}. In MySQL, there is another entry 
named ``slow-query-log-file'' used to specify the log path.
With \app, this user can get the following result:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    TYPE ERROR: Expected a Int with P=1.0 for
    "slow-query-log"
\end{lstlisting} 

\para{Example~4: Ordering error} 
Ordering errors were reported by Yin {\em et al.}~\cite{yin11anempirical} and our first
example illustrates how ordering errors can cause a system to crash. When a user configures PHP 
to run with the
Apache HTTP Server, most likely the user will take some already existing configuration files and adapt them
to suit her needs. The configuration file might contain, among others, 
the following lines:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    extension = mysql.so
        ...
    extension = recode.so
\end{lstlisting}

This configuration file will cause the Apache server to 
fail to start due to a segmentation fault error. 
This is because, when using PHP in Apache, the extension {\tt mysql.so} 
depends on {\tt recode.so}, and their relative ordering
is crucial. 
We call the above example of a misconfiguration file
an {\em ordering error}.
Yin {\em et al.} report that ordering errors widely exist in
many system configurations, \eg, PHP and MySQL,
and typically lead to multiple system crash events.
However, no existing tool can effectively solve 
or detect this problem~\cite{zhang14encore, xu15systems, xu13do}.

By invoking \app, the user can detect such a configuration error.
In particular, \app reports that {\tt recode.so} 
should appear before {\tt mysql.so}, as shown
below:
 
\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    ORDERING ERROR: Expected "extension=recode.so"
    BEFORE "extension=mysql.so"
\end{lstlisting} 



%The above result means that we need to assign an integer value to
%the entry ``general\_log''. 
