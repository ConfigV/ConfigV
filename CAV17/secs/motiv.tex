\section{Motivating Examples}
\label{sec:motiv}

In this section we present the capability of \app through 
detecting errors in several real-world misconfiguration examples. 
These examples were non-trivial configuration errors
that were reported on StackOverflow~\cite{stackoverflow},
a popular question and answer website for programmers and administrators. 
%To better understand these problems, 
%we explored and analyzed misconfigurations 
%on a large number of user forums and on-line discussion sites.

\para{Example~1: Missing entry error} 
Many critical system outages result from the fact that an important
entry was missing from the configuration file. 
We call such a problem a {\em missing entry error}.
In a public misconfiguration 
dataset~\cite{configdataset}, many misconfiguration issues were 
reported as missing entry errors.
Below is a real-world missing entry error example~\cite{missingentry}:
when a user configures her PHP and PostgreSQL,
she needs to use both \code{pgsql.so} and \code{curl.so}
in her \code{/ctc/php5/conf.d/curl.ini} file.
Specifically, this is usually
achieved by the following entries in 
the curl configuration file:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    extension=pgsql.so
    extension=curl.so
    ...
\end{lstlisting} 

Nevertheless, in this example, the user 
left out the \code{extension=pgsql.so} entry, 
as done by many users~\cite{yin11anempirical, missingentry}, 
causing a segmentation fault. 
If the user runs \app on such a misconfiguration file,
\app would return:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    MISSING ENTRY ERROR: Expected "extension=pgsal.so"
    in the same file: "extension=curl.so"
\end{lstlisting} 

%TODO would be nice to have these as subsection or somehow be able to ref specific examples
\para{Example~2: Fine-grained integer correlation error}
\label{ex:fine}
Our second misconfiguration example~\cite{correlation} 
comes from a discussion on StackOverflow.
The user has configured her MySQL as in the following:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
  ...
  max_connections               = 64
  thread_cache_size             = 8
  thread_concurrency            = 8

  key_buffer_size               = 4G
  max_heap_table_size           = 128M

  join_buffer_size              = 32M
  sort_buffer_size              = 32M    
  ...
\end{lstlisting} 

The user complains that her MySQL load was very high, 
causing the website's response speed to be very slow.
The accepted answer to the post reveals that \code{key\_buffer\_size} 
is used by all the threads cooperatively, 
while \code{join\_buffer} and \code{sort\_buffer} are created 
by each thread for private use.
By further consulting the MySQL manual, 
we are instructed that when setting \code{key\_buffer\_size} we should consider the memory requirement of other storage engines.
In a very indirect manner, we have learned that there is a correlation
between \code{key\_buffer\_size} and other buffer sizes of the system.
\app is able to learn a specific constraint, \ie
\code{key\_buffer\_size} should not be greater than
\code{sort\_buffer\_size} * \code{max\_connections}.
If we run \app on the above configuration file, \app will give an explicit answer:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
FINE GRAINED ERROR: Expected 
  "max_connections" * "sort_buffer_size" >= "key_buffer_size"
\end{lstlisting} 

The above example is a complex integer correlation, which implicitly
includes a computational correlation among different entries
in the configuration file.
We call these {\em fine-grained integer correlations}. 
Our tool can detect simple integer correlation---one entry's
value should have a certain correlation with another entry's 
value---as well.
For example, in MySQL, the value of \code{key\_buffer} 
should be larger than \code{max\_allowed\_packet}.
Few existing tools~\cite{yin11anempirical, zhang14encore}
can detect simple integer correlation errors,
but to the best of our knowledge, \app is the first capable of
detecting fine-grained integer correlation errors.

\para{Example~3: Type errors} 
Many system availability problems are caused by 
assigning incorrect type of values to some key in configuration
files. Consider the following real-world misconfiguration
file in github~\cite{typeerror}:
a user tries to install MySQL and she needs to initiate the path
of the log information generated by MySQL.
This user puts the following entry assignment in her MySQL
configuration file: 

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
    slow-query-log = /var/log/mysql/slow.log
\end{lstlisting} 

Unbeknownst to this user, the entry \code{slow-query-log} should be an 
integer, not a string. This misconfiguration will lead to 
MySQL fails to start~\cite{querylog}. In MySQL, there is another entry 
named ``slow-query-log-file'' used to specify the log path.
With \app, this user can get the following result:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
TYPE ERROR: Expected an integer type for "slow-query-log"
\end{lstlisting} 

\para{Example~4: Ordering error} 
Ordering errors in software configurations were first reported by 
Yin {\em et al.}~\cite{yin11anempirical}, but little existing work
can detect such sophisticated errors. The following example
illustrates how the ordering error in a MySQL configuration file
can cause the system to crash~\cite{innod-ordering}. 
%The configuration file might contain, among others, the following lines:

\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
  innodb_data_file_path          = ibdata1:10M:autoextend
  innodb_data_home_dir           = /var/lib/mysql
  innodb_flush_log_at_trx_commit = 1
  innodb_lock_wait_timeout       = 50
  ... 
\end{lstlisting}

By invoking \app, the user can detect an ordering error in the
above configuration file.
In particular, \app reports that \code{innodb\_home\_dir} 
should appear before \code{innodb\_data\_file\_path}, as shown
below:
 
\begin{lstlisting}[language=C, xleftmargin=.01\textwidth]
ORDERING ERROR: Expected "innodb_data_home_dir[mysqld]" BEFORE
  "innodb_data_file_path[mysqld]" 
\end{lstlisting} 


%The above result means that we need to assign an integer value to
%the entry ``general\_log''. 
